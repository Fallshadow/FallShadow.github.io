# 简介

SCS 全名：USimpleConstructionScript

它是 蓝图类内部用于描述组件层级的脚本/数据结构。

你在蓝图编辑器里：左侧的 Components 面板里的组件树（Root、StaticMeshComponent、ChildActorComponent 等），这些组件的 默认属性、附着关系，本质上都由 SCS 里的一个个 USCS_Node 节点 来描述。

都被存成一棵树：USimpleConstructionScript → 若干 USCS_Node

```Cpp
UBlueprint* NewBP = ...; // 某个 Actor 蓝图
USimpleConstructionScript* SCS = NewBP->SimpleConstructionScript;
```

NewBP->SimpleConstructionScript 就是你这张蓝图的 “组件脚本”。

# SCS 存了什么？

## USimpleConstructionScript

核心结构： USimpleConstructionScript

持有 RootNodes（根节点数组），每个 RootNode 是一个 USCS_Node

## USCS_Node

表示蓝图里的「一个组件节点」

成员大概包括：
- UClass* ComponentClass：比如 UStaticMeshComponent
- UActorComponent* ComponentTemplate：模板组件（CDO 用它来拷贝默认值）
- TArray<USCS_Node*> ChildNodes：子节点
- FName VariableName：在蓝图里看到的组件名（如 StaticMesh / Plane_0）

当蓝图编译 / 运行时：
- 引擎根据 SCS 里的 USCS_Node 树
- 为每个节点创建一个实际的组件实例（基于 ComponentTemplate 拷贝）
- 按 ChildNodes 建立 Attach 关系

所以你在 SCS 里改模板组件的属性，相当于改 “这个蓝图类默认带出来的组件长什么样”。

# 应用

## 给蓝图创建新的组件节点

SCS->CreateNode(UStaticMeshComponent::StaticClass(), "MyMesh") 创建静态网格节点

再用 RootNode->AddChildNode(...) 挂到根下

设置这些节点对应的模板组件属性：

```Cpp
if (UStaticMeshComponent* Template = Cast<UStaticMeshComponent>(Node->ComponentTemplate))
{
    Template->SetStaticMesh(TarMesh);
    Template->SetRelativeLocation(Loc);
    Template->SetMobility(EComponentMobility::Static);
}
```

# API

## 获取蓝图的 SCS

```Cpp
USimpleConstructionScript* SCS = NewBP->SimpleConstructionScript;
if (!SCS) { ... }
```

## 新建 Root 节点

```Cpp
const TArray<USCS_Node*>& RootNodes = SCS->GetRootNodes();
USCS_Node* RootNode = nullptr;

if (RootNodes.Num() == 0)
{
    RootNode = SCS->CreateNode(USceneComponent::StaticClass(), FName("DefaultSceneRoot"));
    SCS->AddNode(RootNode);
}
else
{
    RootNode = RootNodes[0];
}
```

一个蓝图可以有多个 RootNode（多个不挂在一起的根组件），一般为了简单，只用第一个，当作主 Root。

## 创建子节点

```Cpp
USCS_Node* PlaneNode = SCS->CreateNode(UStaticMeshComponent::StaticClass(), *CompName);
RootNode->AddChildNode(PlaneNode);

if (UStaticMeshComponent* PlaneTemplate = Cast<UStaticMeshComponent>(PlaneNode->ComponentTemplate))
{
    PlaneTemplate->SetStaticMesh(TarMesh);
    PlaneTemplate->SetMobility(EComponentMobility::Static);
    PlaneTemplate->SetRelativeLocation(Loc);
}
```

## 删除 / 清理节点

```Cpp
TArray<USCS_Node*> Children = RootNode->ChildNodes;
for (USCS_Node* Child : Children)
{
    SCS->RemoveNodeAndPromoteChildren(Child);
}
```

RemoveNodeAndPromoteChildren：删节点但把它的子节点提升到上一层，防止树断裂

如果你想整个子树全删，也有对应的 API（版本不同略有差异）。
