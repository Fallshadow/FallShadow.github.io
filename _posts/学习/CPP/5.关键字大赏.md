# constexpr 

常量表达式关键字，常量关键字

## 简介

constexpr（constant expression，常量表达式）声明的变量或函数，要求其值在编译期就能确定，让编译器能直接参与常量求值和优化。

主要作用有两个：

### 声明编译期常量

使变量/对象在编译阶段就有确定值（不是运行期才生成）。  
可用于数组大小，模板参数，枚举等所有要求常量表达式的场合。  

### 编译期函数计算

允许你写出能在编译期执行的函数（不仅仅只能对普通变量常量生效）。   
支持递归、条件、类构造等多种场景。   

## 与 const 区别

|                    | const              | constexpr                  |
| ------------------ | ------------------ | -------------------------- |
| 语义               | 修饰只读（不能改） | 修饰常量表达式（编译时值） |
| 初始化             | 可以运行时赋值     | 必须编译期可赋值           |
| 可否用于常量表达式 | 有时可以           | 一定可以                   |
| 表达式限制         | 少                 | 更严格                     |
| 函数修饰           | 不能修饰           | 可修饰函数                 |

## 用法

### 变量

对于变量，constexpr 表示该变量的值在编译时就可以确定。

```Cpp

constexpr int N = 10;     // 编译时常量  

```

应用场景：  
使用 constexpr 可以优化代码，因为它允许在编译时进行计算，减少运行时开销。  
例如，用于数组大小、模板参数、常量表达式等。  

### 函数

当我们使用 constexpr 修饰函数时，它表明该函数可以在编译时求值，而不仅仅在运行时。

constexpr 函数应该满足以下条件：
- 函数体内只能包含一条 return 语句（C++11）或多条语句（C++14 及更高版本）。
- 函数只能引用常量全局变量。
- 函数只能调用其他 constexpr 函数，而不能调用普通函数。
- 函数不能是 void 类型。

```Cpp

constexpr int add(int a, int b) 
{
    return a + b;
}

```
