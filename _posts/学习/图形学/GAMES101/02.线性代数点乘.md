- [向量点乘在图形学的应用与原理](#向量点乘在图形学的应用与原理)
- [点乘的数学定义与原理](#点乘的数学定义与原理)
- [投影（Projection）](#投影projection)
  - [1) 标量投影（投影长度 / 分量）](#1-标量投影投影长度--分量)
  - [2) 向量投影（投影向量）](#2-向量投影投影向量)
    - [原理](#原理)
      - [1) 先确定投影向量长什么样](#1-先确定投影向量长什么样)
      - [2) 用“正交条件”确定 (k)](#2-用正交条件确定-k)
      - [3) 为什么分母是 (|\\vec b|^2)（直觉）](#3-为什么分母是-vec-b2直觉)
- [在计算机图形学中的主要应用](#在计算机图形学中的主要应用)
  - [光照计算（Lighting Calculation）](#光照计算lighting-calculation)
  - [镜面反射（Specular Reflection）](#镜面反射specular-reflection)
  - [背面剔除（Back-face Culling）](#背面剔除back-face-culling)
  - [视野检测（Field of View Checking）](#视野检测field-of-view-checking)
  - [投影与阴影计算（Shadow Projection）](#投影与阴影计算shadow-projection)
- [总结表](#总结表)
- [思维路线图](#思维路线图)
- [练习一：向量投影](#练习一向量投影)
  - [1) 点乘](#1-点乘)
  - [2) 标量投影（投影长度）](#2-标量投影投影长度)
  - [3) 向量投影](#3-向量投影)
  - [4) 分解与验证](#4-分解与验证)


# 向量点乘在图形学的应用与原理

向量点乘（Dot Product）在**计算机图形学（Computer Graphics）**中是一个极其重要的基础工具，用于光照、投影、角度计算、法线判断等多种场景。下面从**原理、几何意义以及常见应用**三个方面来解释。

---

# 点乘的数学定义与原理

给定两个向量：

$$
\vec{a} = (a_x, a_y, a_z), \quad \vec{b} = (b_x, b_y, b_z)
$$

则它们的 **点积 dot product** 定义为：

$$
\vec{a} \cdot \vec{b} = a_x b_x + a_y b_y + a_z b_z
$$

这是代数定义。

从几何角度，点乘可以表示为：

$$
\vec{a} \cdot \vec{b} = |\vec{a}| |\vec{b}| \cos{\theta}
$$

其中：

- $|\vec{a}|$、$|\vec{b}|$ 是向量的长度
- $\theta$ 是两向量之间的夹角  

如果两个向量都是单位向量（长度为 1），则：

$$
\vec{a} \cdot \vec{b} = \cos{\theta}
$$

> 意味着点乘告诉我们方向相似程度：
> - $\vec{a} \cdot \vec{b} = 1$ ：方向相同  
> - $\vec{a} \cdot \vec{b} = 0$ ：垂直  
> - $\vec{a} \cdot \vec{b} = -1$ ：反向  

---

# 投影（Projection）

点乘可视为“一个向量在另一个向量方向上的投影长度”。

在图形学中，这用于求光线方向、视线方向在法线方向上的分量。

## 1) 标量投影（投影长度 / 分量）

\[
\mathrm{comp}_{\vec b}(\vec a)=\frac{\vec a\cdot \vec b}{\|\vec b\|}\quad(\vec b\neq \vec 0)
\]
若 \(\vec b\) 是单位向量 \(\hat b\)，则
\[
\mathrm{comp}_{\hat b}(\vec a)=\vec a\cdot \hat b
\]

## 2) 向量投影（投影向量）

\[
\mathrm{proj}_{\vec b}(\vec a)=\left(\frac{\vec a\cdot \vec b}{\|\vec b\|^2}\right)\vec b
\]
若 \(\vec b\) 是单位向量 \(\hat b\)，则
\[
\mathrm{proj}_{\hat b}(\vec a)=(\vec a\cdot \hat b)\hat b
\]

### 原理

向量投影的“原理”其实就一句话：**找一个沿 \(\vec b\) 方向的向量，使它和 \(\vec a\) 在 \(\vec b\) 方向上的分量完全一致**。

---

#### 1) 先确定投影向量长什么样

投影到 \(\vec b\) 上的结果一定**平行于 \(\vec b\)**，所以它只能是
\[
\mathrm{proj}_{\vec b}(\vec a)=k\,\vec b
\]
其中 \(k\) 是某个实数（缩放系数）。

#### 2) 用“正交条件”确定 \(k\)

投影的定义等价于：把 \(\vec a\) 分成
\[
\vec a=\vec a_{\parallel}+\vec a_{\perp}
\]
其中 \(\vec a_{\parallel}\) 平行于 \(\vec b\)，\(\vec a_{\perp}\) 垂直于 \(\vec b\)。

而 \(\vec a_{\parallel}\) 就是投影向量，所以 \(\vec a_{\parallel}=k\vec b\)。

垂直条件是：
\[
(\vec a-\vec a_{\parallel})\cdot \vec b=0
\]
代入 \(\vec a_{\parallel}=k\vec b\)：
\[
(\vec a-k\vec b)\cdot \vec b=0
\]
展开：
\[
\vec a\cdot \vec b-k(\vec b\cdot \vec b)=0
\]
解出 \(k\)：
\[
k=\frac{\vec a\cdot \vec b}{\vec b\cdot \vec b}=\frac{\vec a\cdot \vec b}{\|\vec b\|^2}
\]

所以
\[
\boxed{\mathrm{proj}_{\vec b}(\vec a)=\left(\frac{\vec a\cdot \vec b}{\|\vec b\|^2}\right)\vec b}
\]

#### 3) 为什么分母是 \(\|\vec b\|^2\)（直觉）

因为你是把 \(\vec b\) 当“方向模板”，但 \(\vec b\) 可能不单位长；要把“沿 \(\vec b\) 的分量大小”换算成“要乘多少倍 \(\vec b\)”就必须除以 \(\vec b\cdot \vec b=\|\vec b\|^2\)。

如果用单位方向 \(\hat b=\vec b/\|\vec b\|\)，公式就更直观：
\[
\mathrm{proj}_{\hat b}(\vec a)=(\vec a\cdot \hat b)\,\hat b
\]

即“分量大小”乘以“单位方向”。

---

# 在计算机图形学中的主要应用

## 光照计算（Lighting Calculation）

最常见应用是**漫反射光照模型（Lambertian Reflection）**。

设：
- $\vec{n}$ = 法线方向
- $\vec{l}$ = 光源方向（均为单位向量）

光照强度：

$$
I = k_d \cdot (\vec{n} \cdot \vec{l})
$$

其中：
- $k_d$ 为材质漫反射系数
- $\vec{n} \cdot \vec{l}$ 是两方向夹角余弦值

> 当 $\vec{n} \cdot \vec{l} < 0$（即光线打在背面），光照强度取 0。

---

## 镜面反射（Specular Reflection）

镜面反射中，点乘用于计算反射方向与视线方向的角度：

$$
I_{spec} = k_s (\vec{r} \cdot \vec{v})^n
$$

其中：
- $\vec{r}$ 是反射光方向
- $\vec{v}$ 是观察方向
- $n$ 为高光系数
- $k_s$ 为镜面反射系数

---

## 背面剔除（Back-face Culling）

在 3D 渲染中，若一个面背向观察者可以跳过渲染。

设：
- $\vec{n}$ 为三角面法线
- $\vec{v}$ 为视线方向  

若：
$$
\vec{n} \cdot \vec{v} > 0
$$

则面朝摄像机；  

若 $\vec{n} \cdot \vec{v} < 0$，则为背面，可剔除。

---

## 视野检测（Field of View Checking）

游戏中用于判断目标是否在角色视野中：

$$
\vec{f} \cdot \vec{d} > \cos(\theta_{fov}/2)
$$

其中：
- $\vec{f}$ ：角色面向方向  
- $\vec{d}$ ：目标方向  
- $\theta_{fov}$ ：视野角  

若不满足，则目标在视野外。

---

## 投影与阴影计算（Shadow Projection）

用于求点在平面上的投影或阴影位置。

若点 $P$ 投影到法线为 $\vec{n}$ 的平面上：

$$
P' = P - (\vec{n} \cdot P + d)\vec{n}
$$

其中 $d$ 为平面常数项。

---

# 总结表

| 应用场景       | 使用公式                                 | 含义                 |
| -------------- | ---------------------------------------- | -------------------- |
| 光照（漫反射） | $\vec{n} \cdot \vec{l}$                  | 计算光线与法线夹角   |
| 镜面反射       | $(\vec{r} \cdot \vec{v})^n$              | 控制高光强度         |
| 背面剔除       | $\vec{n} \cdot \vec{v} < 0$              | 判断面向             |
| 视野检测       | $\vec{f} \cdot \vec{d} > \cos(\theta/2)$ | 判断目标是否在视野中 |
| 投影计算       | $(\vec{a} \cdot \vec{b}) \vec{b} $       | 向量投影分量         |

# 思维路线图

- 点乘坐标相乘公式
- 计算夹角点乘公式
- 投影计算，标量投影和向量投影
- 分解向量
- 向量接近远离程度，前后程度

# 练习一：向量投影

题目：设向量 \(\mathbf a=(3,4)\)，\(\mathbf b=(1,2)\)。

1) 计算点乘 \(\mathbf a\cdot \mathbf b\)。  
2) 求 \(\mathbf a\) 在 \(\mathbf b\) 方向上的**标量投影** \(\mathrm{comp}_{\mathbf b}(\mathbf a)\)。  
3) 求 \(\mathbf a\) 在 \(\mathbf b\) 上的**向量投影** \(\mathrm{proj}_{\mathbf b}(\mathbf a)\)。  
4) 求 \(\mathbf a\) 分解为平行于 \(\mathbf b\) 与垂直于 \(\mathbf b\) 的两部分：\(\mathbf a=\mathbf a_{\parallel}+\mathbf a_{\perp}\)，并验证 \(\mathbf a_{\perp}\cdot \mathbf b=0\)。

## 1) 点乘

\[
\mathbf a\cdot \mathbf b=3\cdot 1+4\cdot 2=11
\]

## 2) 标量投影（投影长度）

\[
\|\mathbf b\|=\sqrt{1^2+2^2}=\sqrt5
\]

\[
\mathrm{comp}_{\mathbf b}(\mathbf a)=\frac{\mathbf a\cdot \mathbf b}{\|\mathbf b\|}=\frac{11}{\sqrt5}
\]

## 3) 向量投影

\[
\mathrm{proj}_{\mathbf b}(\mathbf a)=\left(\frac{\mathbf a\cdot \mathbf b}{\|\mathbf b\|^2}\right)\mathbf b
=\left(\frac{11}{5}\right)(1,2)=\left(\frac{11}{5},\frac{22}{5}\right)
\]

## 4) 分解与验证

\[
\mathbf a_{\parallel}=\mathrm{proj}_{\mathbf b}(\mathbf a)=\left(\frac{11}{5},\frac{22}{5}\right)
\]

\[
\mathbf a_{\perp}=\mathbf a-\mathbf a_{\parallel}=(3,4)-\left(\frac{11}{5},\frac{22}{5}\right)=\left(\frac{4}{5},-\frac{2}{5}\right)
\]

验证正交：

\[
\mathbf a_{\perp}\cdot \mathbf b=\left(\frac{4}{5}\right)\cdot 1+\left(-\frac{2}{5}\right)\cdot 2=\frac45-\frac45=0
\]