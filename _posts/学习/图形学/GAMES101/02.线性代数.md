# 向量点乘在图形学的应用与原理

向量点乘（Dot Product）在**计算机图形学（Computer Graphics）**中是一个极其重要的基础工具，用于光照、投影、角度计算、法线判断等多种场景。下面从**原理、几何意义以及常见应用**三个方面来解释。

---

## 点乘的数学定义与原理

给定两个向量：

$$
\vec{a} = (a_x, a_y, a_z), \quad \vec{b} = (b_x, b_y, b_z)
$$

则它们的 **点积 dot product** 定义为：

$$
\vec{a} \cdot \vec{b} = a_x b_x + a_y b_y + a_z b_z
$$

这是代数定义。

从几何角度，点乘可以表示为：

$$
\vec{a} \cdot \vec{b} = |\vec{a}| |\vec{b}| \cos{\theta}
$$

其中：

- $|\vec{a}|$、$|\vec{b}|$ 是向量的长度
- $\theta$ 是两向量之间的夹角  

如果两个向量都是单位向量（长度为 1），则：

$$
\vec{a} \cdot \vec{b} = \cos{\theta}
$$

> 意味着点乘告诉我们方向相似程度：
> - $\vec{a} \cdot \vec{b} = 1$ ：方向相同  
> - $\vec{a} \cdot \vec{b} = 0$ ：垂直  
> - $\vec{a} \cdot \vec{b} = -1$ ：反向  

---

## 点乘的几何意义

### 投影（Projection）

点乘可视为“一个向量在另一个向量方向上的投影长度”。

$$
\text{proj}_{\vec{b}}(\vec{a}) = \frac{\vec{a} \cdot \vec{b}}{|\vec{b}|}
$$

若 $\vec{b}$ 是单位向量，则：

$$
\text{proj}_{\vec{b}}(\vec{a}) = \vec{a} \cdot \vec{b}
$$

在图形学中，这用于求光线方向、视线方向在法线方向上的分量。

---

## 在计算机图形学中的主要应用

### 光照计算（Lighting Calculation）

最常见应用是**漫反射光照模型（Lambertian Reflection）**。

设：
- $\vec{n}$ = 法线方向
- $\vec{l}$ = 光源方向（均为单位向量）

光照强度：

$$
I = k_d \cdot (\vec{n} \cdot \vec{l})
$$

其中：
- $k_d$ 为材质漫反射系数
- $\vec{n} \cdot \vec{l}$ 是两方向夹角余弦值

> 当 $\vec{n} \cdot \vec{l} < 0$（即光线打在背面），光照强度取 0。

---

### 镜面反射（Specular Reflection）

镜面反射中，点乘用于计算反射方向与视线方向的角度：

$$
I_{spec} = k_s (\vec{r} \cdot \vec{v})^n
$$

其中：
- $\vec{r}$ 是反射光方向
- $\vec{v}$ 是观察方向
- $n$ 为高光系数
- $k_s$ 为镜面反射系数

---

### 背面剔除（Back-face Culling）

在 3D 渲染中，若一个面背向观察者可以跳过渲染。

设：
- $\vec{n}$ 为三角面法线
- $\vec{v}$ 为视线方向  

若：
$$
\vec{n} \cdot \vec{v} > 0
$$

则面朝摄像机；  

若 $\vec{n} \cdot \vec{v} < 0$，则为背面，可剔除。

---

### 视野检测（Field of View Checking）

游戏中用于判断目标是否在角色视野中：

$$
\vec{f} \cdot \vec{d} > \cos(\theta_{fov}/2)
$$

其中：
- $\vec{f}$ ：角色面向方向  
- $\vec{d}$ ：目标方向  
- $\theta_{fov}$ ：视野角  

若不满足，则目标在视野外。

---

### 投影与阴影计算（Shadow Projection）

用于求点在平面上的投影或阴影位置。

若点 $P$ 投影到法线为 $\vec{n}$ 的平面上：

$$
P' = P - (\vec{n} \cdot P + d)\vec{n}
$$

其中 $d$ 为平面常数项。

---

## 总结表

| 应用场景       | 使用公式                                 | 含义                 |
| -------------- | ---------------------------------------- | -------------------- |
| 光照（漫反射） | $\vec{n} \cdot \vec{l}$                  | 计算光线与法线夹角   |
| 镜面反射       | $(\vec{r} \cdot \vec{v})^n$              | 控制高光强度         |
| 背面剔除       | $\vec{n} \cdot \vec{v} < 0$              | 判断面向             |
| 视野检测       | $\vec{f} \cdot \vec{d} > \cos(\theta/2)$ | 判断目标是否在视野中 |
| 投影计算       | $(\vec{a} \cdot \vec{b}) \vec{b} $       | 向量投影分量         |

